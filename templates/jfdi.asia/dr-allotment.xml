<? data._total_new_shares = data.parties.new_investor.map(function(p){return p.num_new_shares}).reduce(function(a,b){return a+b}, 0); ?>
<?!= include("inc_dr_start", data, {
  director_or_member:"Director",
  article_pursuant:data.article_for_directors_resolution_in_writing,
  chapter_header:"Allotment of " + data.security_type_long,
  r_num: 3 }) ?>
<a_left_sidehead>Shares to be Issued</a_left_sidehead>
<para_1>That pursuant to the authority given to the Directors <?
  if (data.egm_or_written_means == "EGM") { ?>at the Extraordinary General Meeting of <?= data.company.name ?> (the "Company") held on <?= data.gm_date ?>
  if (data.egm_or_written_means == "AGM") { ?>at the Annual General Meeting of <?= data.company.name ?> (the "Company") held on <?= data.gm_date ?>
<? } else { ?>by the Members of the Company in a resolution passed by written means<? } ?>, under Section 161 of the Companies Act (Cap. 50)</para_1>
<? data._subscription_agreement_dates = data.parties.new_investor.map(function(p){Logger.log("trying to convert date of subscription agreement " + p.date_of_subscription_agreement);
  return Utilities.formatDate(new Date(p.date_of_subscription_agreement),
                              data._timezone,
                             "d MMMM YYYY")});
   if (data._subscription_agreement_dates.filter(function(d){return d===data._subscription_agreement_dates[0]}).length
                                                                          == data._subscription_agreement_dates.length) { // all the same
      data._subscription_agreement_dates = data._subscription_agreement_dates.splice(0,1);
   }
   data._subscription_agreement_dates_array = data._subscription_agreement_dates;
   data._subscription_agreement_dates = commaAnd(data._subscription_agreement_dates);
 ?>
<para_2>and pursuant to the Subscription <?= plural(data._subscription_agreement_dates_array, "Agreement") ?> dated <?= data._subscription_agreement_dates ?> signed among the Company, <?=
commaAnd([data.parties.promoter[0].name].concat(
          data.parties.new_investor.map(function(p){return p.name}))) ?>,</para_2>
<para_2>the Company do hereby approve the allotment of <?= data._total_new_shares ?> <?= data.security_type_long ?> (<?= data.security_type_short ?>) in the share capital of the Company at <?= data.price_per_share ?> each for cash consideration as follows:</para_2>
<para_1>
<Table aid:table="table" aid:tcols="3" aid:trows="<?= data.parties.new_investor.length+1 ?>" xmlns:aid="http://ns.adobe.com/AdobeInDesign/4.0/">
<Cell aid:ccols="1" aid:ccolwidth="150" aid:crows="1" aid:table="cell" aid5:cellstyle="border_none"><cell_c>Name</cell_c></Cell>
<Cell aid:ccols="1" aid:ccolwidth="56" aid:crows="1" aid:table="cell" aid5:cellstyle="border_none"><cell_c>Number of <?= data.security_type_short ?></cell_c></Cell>
<Cell aid:ccols="1" aid:ccolwidth="80" aid:crows="1" aid:table="cell" aid5:cellstyle="border_none"><cell_c>Consideration</cell_c></Cell>
<? for (var i = 0; i<data.parties.new_investor.length; i++) { with(data.parties.new_investor[i]) { ?>
<Cell aid:ccols="1" aid:ccolwidth="150" aid:crows="1" aid:table="cell" aid5:cellstyle="horizontal_hairline"><cell_c><?= name ?></cell_c></Cell>
<Cell aid:ccols="1" aid:ccolwidth="56" aid:crows="1" aid:table="cell" aid5:cellstyle="horizontal_hairline"><cell_c><?= num_new_shares ?></cell_c></Cell>
<Cell aid:ccols="1" aid:ccolwidth="80" aid:crows="1" aid:table="cell" aid5:cellstyle="horizontal_hairline"><cell_c><?= new_commitment ?></cell_c></Cell>
<? } } ?>
</Table>
</para_1>
<a_left_sidehead>Share Certificates to be Issued</a_left_sidehead>
<para_1>That the Common Seal of the Company be affixed in accordance with the Company's Articles of Association to the share certificate to be issued to the aforesaid <?= plural(data.parties.new_investor, "investor") ?>.</para_1>

<?!= include("inc_authority_to_bizfile", data, {what:"aforesaid allotment"}) ?>

<?!= include("inc_dr_end", data, { date: data.agreement_date } ) ?>

